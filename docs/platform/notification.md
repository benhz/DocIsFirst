# 消息通知

## 通知渠道

### 站内信
- 实时推送
- 消息中心查看
- 支持已读/未读状态

### 邮件通知
- 重要事件通知
- 支持批量发送
- 可配置模板

### 短信通知
- 验证码
- 紧急告警
- 有频率限制

### 企业微信/钉钉
- 实时消息推送
- 支持群通知
- 支持卡片消息

## 通知类型

### 系统通知
- 系统维护公告
- 版本更新通知
- 安全告警

### 业务通知
- 任务完成提醒
- 审批流程通知
- 数据报表推送

### 个人通知
- @我的消息
- 评论回复
- 权限变更

## 通知配置

### 个人设置
在「通知设置」页面可配置：
- 勾选需要接收的通知类型
- 选择通知渠道
- 设置免打扰时间

### 示例配置
```
系统维护通知：
  ✓ 站内信
  ✓ 邮件
  ✗ 短信

任务完成通知：
  ✓ 站内信
  ✓ 企业微信
  ✗ 邮件
```

## 开发者使用

### 发送通知 API
```bash
POST /api/v1/notifications

{
  "recipient": "user@example.com",
  "channel": "email",
  "template": "task_complete",
  "data": {
    "task_name": "数据导入",
    "status": "成功"
  }
}
```

### Webhook 回调
支持配置 Webhook，在特定事件发生时自动推送：
```json
{
  "event": "task.completed",
  "timestamp": "2025-12-03T10:00:00Z",
  "data": { ... }
}
```

详见 [Webhook 文档](../api/webhook/overview.md)

## 消息模板

### 可用模板
- `verify_code`：验证码
- `task_complete`：任务完成
- `approval_needed`：待审批
- `system_alert`：系统告警

### 自定义模板
管理员可创建自定义模板，使用变量占位符：
```
尊敬的 {{user_name}}，
您的任务「{{task_name}}」已完成。
查看详情：{{detail_url}}
```

## 常见问题

### Q：为什么收不到通知？
A：检查以下几点：
1. 通知设置是否开启
2. 邮箱/手机号是否正确
3. 是否被垃圾邮件拦截

### Q：如何关闭某类通知？
A：进入「通知设置」，取消勾选即可。

### Q：通知有延迟吗？
A：站内信和企业微信通常是实时的，邮件可能有几分钟延迟。
